define(["jquery","core/log","mod_pchat/conversationconstants","mod_pchat/definitions","core/notification","mod_pchat/previewhelper","mod_pchat/conversationeditor","mod_pchat/vtthelper"],function(a,b,c,d,e,f,g,h){"use strict";return b.debug("PChat Transcript Editor: initialising"),{init:function(a){var b=this.init_controls(a);this.register_events(a,b),g.init([],c.mediatype_audio),f.init();var d=a.mediaurl,e=b.updatecontrol.val();this.loadMedia(d),this.loadJSON(e),g.doSave=function(){var a=g.fetchTranscriptionData();b.updatecontrol.val(JSON.stringify(a))}},init_controls:function(b){var d={};return d.updatecontrol=a('[name="'+b.updatecontrol+'"]'),d.savebutton=a(c.savebutton),d.removeallbutton=a(c.removeallbutton),d},register_events:function(a,b){},loadMedia:function(a){a&&""!==a&&f.setMediaURL(a)},loadVTT:function(b){b&&""!==b&&a.get(b,function(a){var b=h.convertVttToJson(a);g.resetData(b)})},loadJSON:function(a){if(a&&""!==a){var b=JSON.parse(a);g.resetData(b)}}}});