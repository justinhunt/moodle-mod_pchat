{"version":3,"sources":["../src/toggleselected.js"],"names":["define","$","log","debug","init","opts","register_events","init_controls","container","item","control","selectedvalue","val","selections","split","i","length","filter","addClass","mode","maxchecks","thecontainer","on","e","updatecontrol","clickednode","newdataid","data","currentvalues","includes","toString","splice","indexOf","push","preventDefault","join","trigger"],"mappings":"AAAAA,OAAM,4BAAC,CAAC,QAAD,CAAU,UAAV,CAAqB,uBAArB,CAA8C,mBAA9C,CAAD,CACF,SAASC,CAAT,CAAWC,CAAX,CAAkC,CAClC,aAMAA,CAAG,CAACC,KAAJ,CAAU,qCAAV,EAEA,MAAM,CAEFC,IAAI,CAAE,cAASC,CAAT,CAAe,CACjB,KAAKC,eAAL,CAAqBD,CAAI,UAAzB,CAAuCA,CAAI,KAA3C,CAAoDA,CAAI,cAAxD,CAA0EA,CAAI,KAA9E,CAAwFA,CAAI,UAA5F,EACA,KAAKE,aAAL,CAAmBF,CAAI,UAAvB,CAAqCA,CAAI,KAAzC,CAAkDA,CAAI,cAAtD,CAAwEA,CAAI,KAA5E,CACH,CALC,CAOFE,aAAa,CAAE,uBAASC,CAAT,CAAoBC,CAApB,CAA0BC,CAA1B,CAAuC,CAClD,GAAIC,CAAAA,CAAa,CAAGV,CAAC,CAAC,WAAYS,CAAZ,CAAsB,KAAvB,CAAD,CAA8BE,GAA9B,EAApB,CACA,GAAGD,CAAH,CAAkB,CAGd,OADIE,CAAAA,CAAU,CAAGF,CAAa,CAACG,KAAd,CAAoB,GAApB,CACjB,CAAQC,CAAC,CAAE,CAAX,CAAcA,CAAC,CAACF,CAAU,CAACG,MAA3B,CAAkCD,CAAC,EAAnC,CAAuC,CACnCd,CAAC,CAAC,IAAMO,CAAN,CAAkB,IAAlB,CAAyBC,CAA1B,CAAD,CAAiCQ,MAAjC,CAAwC,YAAcJ,CAAU,CAACE,CAAD,CAAxB,CAA8B,GAAtE,EAA2EG,QAA3E,CAAoF,QAApF,CACH,CACJ,CACJ,CAhBC,CAkBFZ,eAAe,CAAE,yBAASE,CAAT,CAAmBC,CAAnB,CAAwBC,CAAxB,CAAiCS,CAAjC,CAAuCC,CAAvC,CAAiD,CAC9D,GAAIC,CAAAA,CAAY,CAAGpB,CAAC,CAAC,IAAMO,CAAP,CAApB,CACAa,CAAY,CAACC,EAAb,CAAgB,OAAhB,CAAyB,IAAMb,CAA/B,CAAqC,SAASc,CAAT,CAAY,IAGzCC,CAAAA,CAAa,CAAIvB,CAAC,CAAC,WAAYS,CAAZ,CAAsB,KAAvB,CAHuB,CAIzCe,CAAW,CAAGxB,CAAC,CAAC,IAAD,CAJ0B,CAKzCyB,CAAS,CAAGD,CAAW,CAACE,IAAZ,CAAiB,IAAjB,CAL6B,CAM7C,OAAOR,CAAP,EACI,IAAK,UAAL,CAEI,GAAIS,CAAAA,CAAa,CAAEJ,CAAa,CAACZ,GAAd,GAAoBE,KAApB,CAA0B,GAA1B,CAAnB,CACA,GAAGc,CAAa,CAACC,QAAd,CAAuBH,CAAS,CAACI,QAAV,EAAvB,CAAH,CAAgD,CAC5CF,CAAa,CAACG,MAAd,CAAqBH,CAAa,CAACI,OAAd,CAAsBN,CAAS,CAACI,QAAV,EAAtB,CAArB,CAAiE,CAAjE,CACH,CAFD,IAEK,CACD,GAAGF,CAAa,CAACZ,MAAd,CAAuBI,CAA1B,CAAqC,CACjCQ,CAAa,CAACK,IAAd,CAAmBP,CAAnB,CACH,CAFD,IAEK,CACDH,CAAC,CAACW,cAAF,GACA,MACH,CACJ,CAGDN,CAAa,CAAGA,CAAa,CAACX,MAAd,CAAqB,SAASM,CAAT,CAAW,CAAC,MAAOA,CAAAA,CAAE,CAA1C,CAAhB,CACAC,CAAa,CAACZ,GAAd,CAAkBgB,CAAa,CAACO,IAAd,CAAmB,GAAnB,CAAlB,EACA,MAEJ,IAAK,OAAL,CACA,QACIX,CAAa,CAACZ,GAAd,CAAkBc,CAAlB,EAtBR,CAyBDF,CAAa,CAACY,OAAd,CAAsB,QAAtB,CACF,CAhCD,CAiCH,CArDC,CAyDT,CAnEK,CAAN","sourcesContent":["define(['jquery','core/log','mod_pchat/definitions', 'core/notification'],\r\n    function($,log, def,notification) {\r\n    \"use strict\"; // jshint ;_;\r\n\r\n/*\r\nThis file contains class and ID definitions.\r\n */\r\n\r\n    log.debug('PChat Toggle Selected: initialising');\r\n\r\n    return{\r\n\r\n        init: function(opts) {\r\n            this.register_events(opts['container'],opts['item'],opts['updatecontrol'],opts['mode'], opts['maxchecks']);\r\n            this.init_controls(opts['container'],opts['item'],opts['updatecontrol'],opts['mode']);\r\n        },\r\n\r\n        init_controls: function(container, item, control,mode){\r\n            var selectedvalue = $('[name=\"' + control + '\"]').val();\r\n            if(selectedvalue) {\r\n                //we could differentiate here between radio and checkbox modes, but split works for both\r\n                var selections = selectedvalue.split(',');\r\n                for(var i =0; i<selections.length;i++) {\r\n                    $('.' + container + ' .' + item).filter('[data-id=' + selections[i] + ']').addClass('active');\r\n                }\r\n            }\r\n        },\r\n\r\n        register_events: function(container,item,control, mode, maxchecks){\r\n            var thecontainer = $('.' + container);\r\n            thecontainer.on('click', '.' + item, function(e) {\r\n\r\n                //we set the new value AND trigger an event in case we are listening for one elsewhere\r\n                var updatecontrol =  $('[name=\"' + control + '\"]');\r\n                var clickednode = $(this);\r\n                var newdataid = clickednode.data('id');\r\n                switch(mode){\r\n                    case 'checkbox':\r\n\r\n                        var currentvalues =updatecontrol.val().split(',');\r\n                        if(currentvalues.includes(newdataid.toString())){\r\n                            currentvalues.splice(currentvalues.indexOf(newdataid.toString()),1);\r\n                        }else{\r\n                            if(currentvalues.length < maxchecks) {\r\n                                currentvalues.push(newdataid);\r\n                            }else{\r\n                                e.preventDefault();\r\n                                return;\r\n                            }\r\n                        }\r\n\r\n                        //clean up any empty values that somehow get in, then set it\r\n                        currentvalues = currentvalues.filter(function(e){return e});\r\n                        updatecontrol.val(currentvalues.join(','));\r\n                        break;\r\n\r\n                    case 'radio':\r\n                    default:\r\n                        updatecontrol.val(newdataid);\r\n\r\n                }\r\n               updatecontrol.trigger('change');\r\n            });\r\n        }\r\n\r\n};//end of return value\r\n\r\n});\r\n\r\n"],"file":"toggleselected.min.js"}