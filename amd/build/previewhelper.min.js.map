{"version":3,"file":"previewhelper.min.js","sources":["../src/previewhelper.js"],"sourcesContent":["define([\"jquery\",\"mod_pchat/conversationconstants\"], function($, constants) {\r\n\r\n    //Preview helper manipulates the audio/video and passing on media events and info to other parts of app\r\n\r\n  return {\r\n\r\n      controls: {},\r\n      mediatype: constants.mediatype_audio,\r\n\r\n      init: function(){\r\n            this.initControls();\r\n      },\r\n\r\n      initControls: function(){\r\n          this.controls.videoplayer = $(constants.videoplayer);\r\n          this.controls.audioplayer = $(constants.audioplayer);\r\n          this.controls.root = $(constants.root);\r\n          if(this.mediatype===constants.mediatype_audio){\r\n              this.controls.mediaplayer = this.controls.audioplayer\r\n          }else {\r\n              this.controls.mediaplayer = this.controls.videoplayer\r\n          }\r\n          this.controls.mediaplayer.show();\r\n      },\r\n\r\n\r\n\r\n      fetchCurrentTime: function(){\r\n         return Math.floor(1000 * this.controls.mediaplayer[0].currentTime);//milliseconds\r\n      },\r\n\r\n      setMediaURL: function(mediaurl){\r\n        if(!mediaurl | mediaurl.trim()==''){return;}\r\n        switch(this.mediatype){\r\n            case constants.mediatype_audio:\r\n                this.mediatype=constants.mediatype_audio;\r\n                this.controls.mediaplayer.off('timeupdate');\r\n                this.controls.mediaplayer = this.controls.audioplayer;\r\n                this.controls.root.addClass('player-audio');\r\n                break;\r\n\r\n            default:\r\n                this.mediatype=constants.mediatype_video;\r\n                this.controls.mediaplayer.off('timeupdate');\r\n                this.controls.mediaplayer = this.controls.videoplayer;\r\n                this.controls.root.removeClass('player-audio');\r\n        }\r\n        this.controls.mediaplayer.attr(\"src\",mediaurl);\r\n        this.controls.mediaplayer[0].load();\r\n      }\r\n    }\r\n});\r\n"],"names":["define","$","constants","controls","mediatype","mediatype_audio","init","initControls","videoplayer","audioplayer","root","this","mediaplayer","show","fetchCurrentTime","Math","floor","currentTime","setMediaURL","mediaurl","trim","off","addClass","mediatype_video","removeClass","attr","load"],"mappings":"AAAAA,iCAAO,CAAC,SAAS,oCAAoC,SAASC,EAAGC,iBAIxD,CAEHC,SAAU,GACVC,UAAWF,UAAUG,gBAErBC,KAAM,gBACKC,gBAGXA,aAAc,gBACLJ,SAASK,YAAcP,EAAEC,UAAUM,kBACnCL,SAASM,YAAcR,EAAEC,UAAUO,kBACnCN,SAASO,KAAOT,EAAEC,UAAUQ,MAC9BC,KAAKP,YAAYF,UAAUG,qBACrBF,SAASS,YAAcD,KAAKR,SAASM,iBAErCN,SAASS,YAAcD,KAAKR,SAASK,iBAEzCL,SAASS,YAAYC,QAK9BC,iBAAkB,kBACRC,KAAKC,MAAM,IAAOL,KAAKR,SAASS,YAAY,GAAGK,cAGzDC,YAAa,SAASC,gBAChBA,SAA4B,IAAjBA,SAASC,YACjBT,KAAKP,YACHF,UAAUG,qBACND,UAAUF,UAAUG,qBACpBF,SAASS,YAAYS,IAAI,mBACzBlB,SAASS,YAAcD,KAAKR,SAASM,iBACrCN,SAASO,KAAKY,SAAS,0BAIvBlB,UAAUF,UAAUqB,qBACpBpB,SAASS,YAAYS,IAAI,mBACzBlB,SAASS,YAAcD,KAAKR,SAASK,iBACrCL,SAASO,KAAKc,YAAY,qBAElCrB,SAASS,YAAYa,KAAK,MAAMN,eAChChB,SAASS,YAAY,GAAGc"}