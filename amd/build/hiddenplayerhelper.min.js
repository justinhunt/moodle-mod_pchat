define(["jquery","core/log","mod_pchat/definitions"],function(a,b,c){"use strict";return b.debug("Readaloud hidden player helper: initialising"),{controls:{},hiddenplayer:c.hiddenplayer,hiddenplayerbutton:c.hiddenplayerbutton,hiddenplayerbuttonactive:c.hiddenplayerbuttonactive,hiddenplayerbuttonpaused:c.hiddenplayerbuttonpaused,hiddenplayerbuttonplaying:c.hiddenplayerbuttonpaused,init:function(a){this.register_controls(),this.register_events()},register_controls:function(){this.controls.hiddenplayer=a("."+this.hiddenplayer),this.controls.hiddenplayerbutton=a("."+this.hiddenplayerbutton),this.controls.playercontrols=a("."+this.hiddenplayerbutton+" i")},register_events:function(){var b=this,c=this.controls.hiddenplayer;this.controls.hiddenplayerbutton.click(function(d){var e=a(this).attr("data-audiosource");e!==c.attr("src")||c.prop("paused")?(b.controls.playercontrols.removeClass("fa-stop-circle"),b.controls.playercontrols.addClass("fa-play-circle"),a(this).find("i").addClass("fa-stop-circle"),b.dohiddenplay(e)):(b.dohiddenstop(),b.controls.playercontrols.removeClass("fa-stop-circle"),b.controls.playercontrols.addClass("fa-play-circle"))})},dohiddenplay:function(a){var b=this,c=b.controls.hiddenplayer;c.attr("src",a),c[0].pause(),c[0].load();var d=c[0].play();void 0!==d&&d.then(function(){})["catch"](function(a){}),b.dobuttonicons()},dohiddenstop:function(){var a=this,b=a.controls.hiddenplayer;b[0].pause(),a.dobuttonicons()},dobuttonicons:function(b){var c=this,d=c.controls.hiddenplayer;b||(b=d.attr("src")),c.controls.hiddenplayerbutton.each(function(e){var f=a(this).attr("data-audiosource");f===b?(a(this).addClass(c.activebutton),d.prop("paused")?(a(this).removeClass(c.hiddenplayerbuttonplaying),a(this).addClass(c.hiddenplayerbuttonpaused),a(this).removeClass(c.hiddenplayerbuttonactive)):(a(this).removeClass(c.hiddenplayerbuttonpaused),a(this).addClass(c.hiddenplayerbuttonplaying))):(a(this).removeClass(c.hiddenplayerbuttonactive),a(this).removeClass(c.hiddenplayerbuttonplaying),a(this).removeClass(c.hiddenplayerbuttonpaused))})}}});