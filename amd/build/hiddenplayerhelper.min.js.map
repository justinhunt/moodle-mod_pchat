{"version":3,"sources":["../src/hiddenplayerhelper.js"],"names":["define","$","log","def","debug","controls","hiddenplayer","hiddenplayerbutton","hiddenplayerbuttonactive","hiddenplayerbuttonpaused","hiddenplayerbuttonplaying","init","register_controls","register_events","playercontrols","that","audioplayer","click","audiosrc","attr","prop","dohiddenstop","removeClass","addClass","find","dohiddenplay","m","pause","load","pp","play","then","catch","dobuttonicons","theaudiosrc","each","activebutton"],"mappings":"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","sourcesContent":["define(['jquery', 'core/log', 'mod_pchat/definitions'], function ($, log, def) {\r\n    \"use strict\"; // jshint ;_;\r\n\r\n    log.debug('P-CHAT hidden player helper: initialising');\r\n\r\n    return {\r\n\r\n        controls: {},\r\n        hiddenplayer: def.hiddenplayer,\r\n        hiddenplayerbutton: def.hiddenplayerbutton,\r\n        hiddenplayerbuttonactive: def.hiddenplayerbuttonactive,\r\n        hiddenplayerbuttonpaused: def.hiddenplayerbuttonpaused,\r\n        hiddenplayerbuttonplaying: def.hiddenplayerbuttonpaused,\r\n\r\n        init: function (opts) {\r\n            this.register_controls();\r\n            this.register_events();\r\n        },\r\n\r\n        register_controls: function () {\r\n            this.controls.hiddenplayer = $('.' + this.hiddenplayer);\r\n            this.controls.hiddenplayerbutton = $('.' + this.hiddenplayerbutton);\r\n            this.controls.playercontrols = $('.' + this.hiddenplayerbutton + ' i');\r\n        },\r\n\r\n        register_events: function () {\r\n            var that = this;\r\n            var audioplayer = this.controls.hiddenplayer;\r\n            //handle the button click\r\n            this.controls.hiddenplayerbutton.click(function (e) {\r\n                var audiosrc = $(this).attr('data-audiosource');\r\n                if (audiosrc === audioplayer.attr('src') && !(audioplayer.prop('paused'))) {\r\n                    that.dohiddenstop();\r\n                    that.controls.playercontrols.removeClass('fa-stop-circle');\r\n                    that.controls.playercontrols.addClass('fa-play-circle');\r\n                } else {\r\n                    that.controls.playercontrols.removeClass('fa-stop-circle');\r\n                    that.controls.playercontrols.addClass('fa-play-circle');\r\n                    $(this).find('i').addClass('fa-stop-circle');\r\n                    that.dohiddenplay(audiosrc);\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n\r\n        dohiddenplay: function (audiosrc) {\r\n            var m = this;\r\n            var audioplayer = m.controls.hiddenplayer;\r\n            audioplayer.attr('src', audiosrc);\r\n            audioplayer[0].pause();\r\n            audioplayer[0].load();\r\n            var pp = audioplayer[0].play();\r\n            if (pp !== undefined) {\r\n                pp.then(function () {\r\n                    // Yay we are playing\r\n                }).catch(function (error) {\r\n                    // somethings up ... but we can ignore it\r\n                });\r\n            }\r\n            m.dobuttonicons();\r\n        },\r\n        dohiddenstop: function () {\r\n            var m = this;\r\n            var audioplayer = m.controls.hiddenplayer;\r\n            audioplayer[0].pause();\r\n            m.dobuttonicons();\r\n        },\r\n\r\n        dobuttonicons: function (theaudiosrc) {\r\n            var m = this;\r\n            var audioplayer = m.controls.hiddenplayer;\r\n            if (!theaudiosrc) {\r\n                theaudiosrc = audioplayer.attr('src');\r\n            }\r\n            m.controls.hiddenplayerbutton.each(function (index) {\r\n                var audiosrc = $(this).attr('data-audiosource');\r\n                if (audiosrc === theaudiosrc) {\r\n                    $(this).addClass(m.activebutton);\r\n                    if (audioplayer.prop('paused')) {\r\n                        $(this).removeClass(m.hiddenplayerbuttonplaying);\r\n                        $(this).addClass(m.hiddenplayerbuttonpaused);\r\n                        //for now we make it look like no button is selected\r\n                        //later we can implement better controls\r\n                        $(this).removeClass(m.hiddenplayerbuttonactive);\r\n                    } else {\r\n                        $(this).removeClass(m.hiddenplayerbuttonpaused);\r\n                        $(this).addClass(m.hiddenplayerbuttonplaying);\r\n                    }\r\n                } else {\r\n                    $(this).removeClass(m.hiddenplayerbuttonactive);\r\n                    $(this).removeClass(m.hiddenplayerbuttonplaying);\r\n                    $(this).removeClass(m.hiddenplayerbuttonpaused);\r\n                }\r\n            });\r\n        }\r\n    };//end of return object\r\n\r\n});"],"file":"hiddenplayerhelper.min.js"}