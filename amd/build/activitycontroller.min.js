define(["jquery","jqueryui","core/log","mod_pchat/definitions"],function(a,b,c,d){"use strict";return c.debug("Activity controller: initialising"),{cmid:null,activitydata:null,recorderid:null,controls:null,clone:function(){return a.extend(!0,{},this)},init:function(b){var d=this.clone(),e="#amdopts_"+b.widgetid,f=a(e).get(0);return f?(d.activitydata=JSON.parse(f.value),a(e).remove(),d.cmid=b.cmid,d.process_html(),void d.register_events()):void c.debug("Read Seed Test Controller: No config found on page. Giving up.")},register_events:function(){},process_html:function(){var b=this.activitydata,c={hider:a("."+b.hider)};this.controls=c},send_submission:function(a,b){var d=new XMLHttpRequest,e=this;d.onreadystatechange=function(a){if(4===this.readyState)if(200==d.status){c.debug("ok we got an attempt submission response");var b=d.responseText,f=JSON.parse(b);if(f)switch(f.success){case!1:c.debug("attempted item evaluation failure"),f.message&&c.debug("message: "+f.message);case!0:default:c.debug("attempted submission accepted"),e.attemptid=f.data,e.doquizlayout()}}else c.debug("Not 200 response:"+d.status)};var f="cmid="+e.cmid+"&filename="+a+"&rectime="+b;d.open("POST",M.cfg.wwwroot+"/mod/pchat/ajaxhelper.php",!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.setRequestHeader("Cache-Control","no-cache"),d.send(f)}}});